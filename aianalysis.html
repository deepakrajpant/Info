<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üîç Smart Load Analysis AI</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, #1a2a6c, #2b6777, #4a9faa);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    .container {
      width: 100%;
      max-width: 800px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 90vh;
    }
    
    .header {
      background: linear-gradient(to right, #1e4c5b, #2b6777);
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .header h2 {
      font-size: 1.8rem;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .subtitle {
      font-size: 1rem;
      opacity: 0.9;
      font-weight: 300;
    }
    
    .chat-container {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 20px;
      background: #f2f4f8;
    }
    
    .message {
      max-width: 80%;
      padding: 15px;
      border-radius: 12px;
      position: relative;
      line-height: 1.5;
      animation: fadeIn 0.3s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .user-message {
      background: linear-gradient(to bottom right, #2b6777, #1e4c5b);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }
    
    .ai-message {
      background: white;
      color: #333;
      align-self: flex-start;
      border-bottom-left-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .message-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      font-weight: 600;
    }
    
    .user-message .message-header {
      color: #b3e5fc;
    }
    
    .ai-message .message-header {
      color: #2b6777;
    }
    
    .input-container {
      padding: 20px;
      background: white;
      border-top: 1px solid #e0e0e0;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .mode-selector {
      display: flex;
      gap: 12px;
      justify-content: center;
      align-items: center;
    }
    
    .mode-btn {
      padding: 8px 15px;
      border-radius: 20px;
      background: #e0e0e0;
      border: none;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .mode-btn.active {
      background: #2b6777;
      color: white;
      box-shadow: 0 4px 8px rgba(43, 103, 119, 0.3);
    }
    
    .input-group {
      display: flex;
      gap: 10px;
    }
    
    input {
      flex: 1;
      padding: 14px 18px;
      border-radius: 30px;
      border: 1px solid #ccc;
      font-size: 16px;
      outline: none;
      transition: all 0.3s;
      box-shadow: inset 0 1px 4px rgba(0,0,0,0.1);
    }
    
    input:focus {
      border-color: #2b6777;
      box-shadow: inset 0 1px 4px rgba(0,0,0,0.1), 0 0 0 2px rgba(43, 103, 119, 0.2);
    }
    
    button {
      padding: 14px 24px;
      border-radius: 30px;
      border: none;
      background: linear-gradient(to right, #2b6777, #1e4c5b);
      color: white;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 12px rgba(43, 103, 119, 0.3);
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(43, 103, 119, 0.4);
    }
    
    .status-message {
      text-align: center;
      padding: 10px;
      color: #2b6777;
      font-style: italic;
      font-size: 14px;
    }
    
    .typing-indicator {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    
    .typing-dot {
      width: 8px;
      height: 8px;
      background: #2b6777;
      border-radius: 50%;
      opacity: 0.6;
      animation: pulse 1.4s infinite;
    }
    
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.2); opacity: 1; }
    }
    
    .message pre {
      background: rgba(0,0,0,0.05);
      padding: 10px;
      border-radius: 8px;
      overflow-x: auto;
      margin-top: 10px;
      font-size: 14px;
    }
    
    .ai-icon, .user-icon {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }
    
    .ai-icon {
      background: #2b6777;
      color: white;
    }
    
    .user-icon {
      background: #1e4c5b;
      color: white;
    }
    
    @media (max-width: 600px) {
      .container {
        height: 95vh;
      }
      
      .header h2 {
        font-size: 1.4rem;
      }
      
      .message {
        max-width: 90%;
      }
      
      .input-group {
        flex-direction: column;
      }
      
      button {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2><i class="fas fa-bolt"></i> Smart Load Analysis AI Assistant</h2>
      <div class="subtitle">Analyzing feeder load data with AI-powered insights</div>
    </div>
    
    <div class="chat-container" id="chat">
      <div class="message ai-message">
        <div class="message-header">
          <div class="ai-icon"><i class="fas fa-robot"></i></div>
          <div>AI Assistant</div>
        </div>
        <div>Hello! I'm your Smart Load Analysis AI Assistant. I can help you analyze electrical load data including voltage, current, MW, and Mvar values.</div>
      </div>
      
      <div class="message ai-message">
        <div class="message-header">
          <div class="ai-icon"><i class="fas fa-robot"></i></div>
          <div>AI Assistant</div>
        </div>
        <div>Please select your preferred answer length and ask questions like:<br>
          ‚Ä¢ Show me peak load times<br>
          ‚Ä¢ Compare feeder performance<br>
          ‚Ä¢ Identify voltage fluctuations<br>
          ‚Ä¢ Provide load summary for last week</div>
      </div>
    </div>
    
    <div class="mode-selector">
      <button class="mode-btn active" data-mode="short">
        <i class="fas fa-align-left"></i> Short
      </button>
      <button class="mode-btn" data-mode="medium">
        <i class="fas fa-align-center"></i> Medium
      </button>
      <button class="mode-btn" data-mode="long">
        <i class="fas fa-align-justify"></i> Detailed
      </button>
    </div>
    
    <div class="input-container">
      <div class="input-group">
        <input type="text" id="userInput" placeholder="Ask about load data (e.g. 'Show peak load times for feeder 3')" />
        <button onclick="sendMessage()">
          <i class="fas fa-paper-plane"></i> Ask AI
        </button>
      </div>
      <div class="status-message" id="status">
        <i class="fas fa-info-circle"></i> Select answer length above and type your question
      </div>
    </div>
  </div>

  <script>
    // Sample data for demonstration
    const sampleCSV = `Timestamp,Feeder,Voltage (kV),Current (A),MW,Mvar
2023-10-01 08:00,Feeder1,11.2,145,1.52,0.32
2023-10-01 08:00,Feeder2,11.1,162,1.68,0.41
2023-10-01 08:00,Feeder3,11.3,138,1.48,0.29
2023-10-01 12:00,Feeder1,10.8,210,2.21,0.52
2023-10-01 12:00,Feeder2,10.7,228,2.38,0.63
2023-10-01 12:00,Feeder3,10.9,195,2.05,0.47
2023-10-01 18:00,Feeder1,11.0,180,1.89,0.42
2023-10-01 18:00,Feeder2,10.9,195,2.05,0.51
2023-10-01 18:00,Feeder3,11.1,168,1.76,0.38`;
    
    // Configuration
    let currentMode = "medium";
    const modeButtons = document.querySelectorAll('.mode-btn');
    
    // Set up mode selection
    modeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        modeButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentMode = btn.dataset.mode;
        document.getElementById('status').innerHTML = `<i class="fas fa-info-circle"></i> Answer mode set to: ${btn.textContent.trim()}`;
      });
    });
    
    // Function to add a message to the chat
    function addMessage(sender, text) {
      const chat = document.getElementById('chat');
      const messageDiv = document.createElement('div');
      messageDiv.classList.add('message');
      
      if (sender === 'user') {
        messageDiv.classList.add('user-message');
        messageDiv.innerHTML = `
          <div class="message-header">
            <div class="user-icon"><i class="fas fa-user"></i></div>
            <div>You</div>
          </div>
          <div>${text}</div>
        `;
      } else {
        messageDiv.classList.add('ai-message');
        messageDiv.innerHTML = `
          <div class="message-header">
            <div class="ai-icon"><i class="fas fa-robot"></i></div>
            <div>AI Assistant</div>
          </div>
          <div>${text}</div>
        `;
      }
      
      chat.appendChild(messageDiv);
      chat.scrollTop = chat.scrollHeight;
    }
    
    // Function to show typing indicator
    function showTyping() {
      const chat = document.getElementById('chat');
      const typingDiv = document.createElement('div');
      typingDiv.classList.add('message', 'ai-message');
      typingDiv.id = 'typing-indicator';
      typingDiv.innerHTML = `
        <div class="message-header">
          <div class="ai-icon"><i class="fas fa-robot"></i></div>
          <div>AI Assistant</div>
        </div>
        <div class="typing-indicator">
          <span class="typing-dot"></span>
          <span class="typing-dot"></span>
          <span class="typing-dot"></span>
        </div>
      `;
      
      chat.appendChild(typingDiv);
      chat.scrollTop = chat.scrollHeight;
      return typingDiv;
    }
    
    // Function to simulate AI response
    function simulateAIResponse(question) {
      const responses = {
        short: {
          "peak": "Peak load occurs at 12:00 across all feeders, with Feeder2 reaching 2.38 MW.",
          "voltage": "Voltage fluctuations observed in Feeder1, dropping to 10.8kV during peak.",
          "compare": "Feeder2 has highest load (2.38MW), Feeder3 most stable voltage.",
          "summary": "Peak: 12:00 (2.38MW), Avg Voltage: 10.97kV, Min Voltage: 10.7kV."
        },
        medium: {
          "peak": "Peak load occurs consistently at 12:00 for all three feeders. Feeder2 reaches the highest load at 2.38 MW, followed by Feeder1 at 2.21 MW, and Feeder3 at 2.05 MW. This suggests the highest demand period is midday.",
          "voltage": "Voltage fluctuations are most noticeable in Feeder1, which drops to 10.8kV during peak hours (12:00) from its morning value of 11.2kV. Feeder3 maintains the most stable voltage profile, varying only between 11.3kV and 10.9kV throughout the day.",
          "compare": "Feeder2 consistently shows the highest load, reaching 2.38 MW at peak. However, it also has the lowest voltage during peak times (10.7kV). Feeder3 has the most stable voltage profile but handles the least load. Feeder1 shows moderate performance in both load and voltage stability.",
          "summary": "On 2023-10-01, peak load occurred at 12:00 with Feeder2 reaching 2.38 MW. Average voltage across all feeders was 10.97kV, with Feeder2 experiencing the lowest voltage (10.7kV) during peak. The day showed typical load progression with morning, midday peak, and evening reduction."
        },
        long: {
          "peak": `Detailed analysis of peak load times:

Based on the provided data for 2023-10-01:
‚Ä¢ Feeder1: 
  - Morning (08:00): 1.52 MW
  - Midday (12:00): 2.21 MW (peak, +45.4% increase)
  - Evening (18:00): 1.89 MW
  
‚Ä¢ Feeder2:
  - Morning: 1.68 MW
  - Midday: 2.38 MW (peak, +41.7% increase)
  - Evening: 2.05 MW

‚Ä¢ Feeder3:
  - Morning: 1.48 MW
  - Midday: 2.05 MW (peak, +38.5% increase)
  - Evening: 1.76 MW

Key observations:
1. All feeders follow similar daily load patterns with peak at midday
2. Feeder2 consistently has the highest load throughout the day
3. The largest relative increase occurs in Feeder1 (+45.4%)
4. Evening load remains significantly higher than morning levels

Recommendations:
- Consider load balancing during peak hours
- Investigate Feeder2 capacity constraints
- Monitor Feeder1 for unusual load patterns`
        }
      };
      
      // Determine response type based on keywords
      let responseType = "compare";
      if (question.toLowerCase().includes("peak")) responseType = "peak";
      if (question.toLowerCase().includes("voltage")) responseType = "voltage";
      if (question.toLowerCase().includes("summary")) responseType = "summary";
      
      // Get the appropriate response based on mode and type
      return responses[currentMode][responseType] || 
             `I've analyzed the load data. The ${currentMode} analysis shows: 
              ‚Ä¢ Peak load at 12:00 (2.38 MW on Feeder2)
              ‚Ä¢ Voltage range: 10.7kV-11.3kV
              ‚Ä¢ Feeder2 has highest load, Feeder3 most stable voltage.
              
              For more details, try changing the answer length.`;
    }
    
    // Modified sendMessage function for demonstration
    async function sendMessage() {
      const input = document.getElementById('userInput');
      const status = document.getElementById('status');
      const userText = input.value.trim();
      
      if (!userText) {
        status.innerHTML = '<i class="fas fa-exclamation-circle"></i> Please enter a question';
        return;
      }
      
      // Add user message
      addMessage('user', userText);
      
      // Clear input
      input.value = '';
      status.innerHTML = `<i class="fas fa-sync-alt fa-spin"></i> Analyzing load data...`;
      
      // Show typing indicator
      const typingIndicator = showTyping();
      
      // Simulate delay for processing
      setTimeout(() => {
        // Remove typing indicator
        typingIndicator.remove();
        
        // Generate simulated response
        const response = simulateAIResponse(userText);
        
        // Add AI response
        addMessage('ai', response);
        
        // Update status
        status.innerHTML = `<i class="fas fa-check-circle"></i> Analysis complete. Mode: ${currentMode.charAt(0).toUpperCase() + currentMode.slice(1)}`;
      }, 2000);
    }
    
    // Allow sending message with Enter key
    document.getElementById('userInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });
  </script>
</body>
</html>
